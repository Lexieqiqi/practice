var encode=(function(){var base64EncodeChars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function utf16to8(str){var out,i,len,c;out="";len=str.length;for(i=0;i<len;i++){c=str.charCodeAt(i);if((c>=1)&&(c<=127)){out+=str.charAt(i)}else{if(c>2047){out+=String.fromCharCode(224|((c>>12)&15));out+=String.fromCharCode(128|((c>>6)&63));out+=String.fromCharCode(128|((c>>0)&63))}else{out+=String.fromCharCode(192|((c>>6)&31));out+=String.fromCharCode(128|((c>>0)&63))}}}return out}function base64encode(str){var out,i,len;var c1,c2,c3;len=str.length;i=0;out="";while(i<len){c1=str.charCodeAt(i++)&255;if(i==len){out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt((c1&3)<<4);out+="==";break}c2=str.charCodeAt(i++);if(i==len){out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt(((c1&3)<<4)|((c2&240)>>4));out+=base64EncodeChars.charAt((c2&15)<<2);out+="=";break}c3=str.charCodeAt(i++);out+=base64EncodeChars.charAt(c1>>2);out+=base64EncodeChars.charAt(((c1&3)<<4)|((c2&240)>>4));out+=base64EncodeChars.charAt(((c2&15)<<2)|((c3&192)>>6));out+=base64EncodeChars.charAt(c3&63)}return out}return function(s){return base64encode(utf16to8(s))}})();$.valid.loginPassword=function(str,min,max){if(!(/^[\dA-Za-z_]*$/g).test(str)){return _("A password is consist of only numbers, letters or underlines.")}if(min||max){return $.valid.len(str,min,max)}};define(function(require,exports,module){var model=new Model();model.extendModels({sysPwd:{fetchUrl:"/goform/getSysTools",submitUrl:"/goform/setSystem",container:$("#pageSysPwd"),getTransfer:function(data){if(data.sysPwd.hasPwd==="true"){return{hasPwd:true}}else{return{hasPwd:false}}},setTransfer:function(data){var submitData={};submitData.module1="setPwd";for(var key in data){if(key!=="confirmPwd"){submitData[key]=encode(data[key])}}return submitData}},reboot:{submitUrl:"/goform/setSystem",setTransfer:function(){var submitData={module1:"sysOperate",action:"reboot"};return submitData}},restore:{submitUrl:"/goform/setSystem",setTransfer:function(){var submitData={module1:"sysOperate",action:"restore"};return submitData}}});var SpecifyViewModule=ViewModule.extend({initialize:function(){},initEvent:function(){var that=this;model=this.model;$("#advanceBackBtn").on(click,function(){window.location.href="/phone/scan.html"});$("#goSysPwd").on(click,(function(){var hasPwd;function showPwdPage(){that.model.setData("sysPwd",{hasPwd:hasPwd});that.renderForModel("sysPwd");goToPage("#pageSysPwd")}return function(){if(typeof hasPwd==="undefined"){model.fetchData("sysPwd",{module1:"sysPwd"},function(data){hasPwd=data.hasPwd;showPwdPage()})}else{showPwdPage()}}})());$("#pageSysPwdTitle").on(click,function(){goToPage("#pageAdvMenu","left");that.reset("#pageSysPwd")});$("#sysPwdSave").on(click,function(){that.saveForModel("sysPwd",function(res){var num=JSON.parse(res).errCode||"-1";if(num=="2"){$.alert(_("Failed to change the password, because the old password is wrong."))}else{if(num=="101"){window.location.href="/phone/login.html"}else{if(num=="102"){$.alert(_("Successful to change the password."));goToPage("#pageAdvMenu","left")}}}})});$("#rebootExtender").on(click,function(){$.showConfirm(_("Are you sure to reboot the device?"),function(){model.saveData("reboot",function(){$.progressBar().run(50000,_("Rebooting…"),function(){var checkRebootT=setInterval(function(){$.ajax({type:"get",url:"/goform/getRebootStatus",dataType:"jsonp",jsonp:"callback",jsonpCallback:"flightHandler",success:function(json){clearInterval(checkRebootT);window.location.href="scan.html"}})},5000)})})})});$("#goRestore").on(click,function(){$.showConfirm(_("Resetting the device will erase all the manual configurations and restore the device to factory default settings."),function(){model.saveData("restore",function(){$.progressBar().run(50000,_("Resetting…"),function(){var checkRebootT=setInterval(function(){$.ajax({type:"get",url:"/goform/getRebootStatus",dataType:"jsonp",jsonp:"callback",jsonpCallback:"flightHandler",success:function(json){clearInterval(checkRebootT);window.location.href="scan.html"}})},5000)})})})})}});var viewModule=new SpecifyViewModule("body",model);module.exports=viewModule});